<!DOCTYPE html>
<html lang="">
<head>
  <meta charset="UTF-8">
  <title>Relat√≥rio Final</title>
  <style>
  :root {
    --color-primary: #005b94;
    --color-highlight: #27ae60;
    --color-wrong: #e74c3c;
    --color-correct-bg: #e6f9ec;
    --color-wrong-bg: #fdecea;
  }

  body {
  font-family: 'Inter', sans-serif;
  background-color: #f5f5f5;
  padding: 30px;
  margin: 0 auto;
  max-width: 900px;
  color: #333;
  }

  h1, h2 {
  color: var(--color-primary);
  text-align: center;
  margin-bottom: 30px;
  }

  .question {
    background: white;
    border-radius: 12px;
    padding: 24px;
    margin-bottom: 30px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.06);
  }

  .option {
  padding: 12px;
  border-radius: 6px;
  margin: 8px 0;
  border: 1px solid #ccc;
  transition: all 0.3s;
  }

  .correct {
    border-left: 5px solid var(--color-highlight);
    background-color: var(--color-correct-bg);
    color: var(--color-highlight);
  }

  .incorrect {
    border-left: 5px solid var(--color-wrong);
    background-color: var(--color-wrong-bg);
    color: var(--color-wrong);
  }

  .explanation {
    margin-top: 18px;
    padding: 12px;
    border-left: 4px solid #ccc;
    background-color: #f9f9f9;
    border-radius: 6px;
  }

  .btn {
    display: inline-block;
    padding: 12px 24px;
    font-size: 16px;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    margin: 10px;
    transition: background 0.3s;
  }

  .btn-primary {
    background-color: var(--color-primary);
    color: white;
  }

  .btn-highlight {
    background-color: var(--color-highlight);
    color: white;
  }

  .btn-warn {
    background-color: var(--color-wrong);
    color: white;
  }

  .summary {
    background: white;
    padding: 20px;
    border-radius: 12px;
    margin-bottom: 30px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.06);
  }

  .summary h3 {
    margin-bottom: 10px;
    color: #333;
  }

  .area-block {
  margin-bottom: 30px;
  padding-left: 10px;
  border-left: 4px solid var(--color-highlight);
}

.area-title {
  font-size: 18px;
  font-weight: 600;
  color: var(--color-highlight);
  margin-bottom: 10px;
  display: flex;
  align-items: center;
  gap: 6px;
}

  .topic-list {
  list-style: none;
  padding-left: 15px;
  position: relative;
  margin: 0;
  }

  .topic-list::before {
  content: "";
  position: absolute;
  left: 6px;
  top: 0;
  bottom: 0;
  width: 2px;
  background-color: #ccc;
  }

 .topic-list li {
  position: relative;
  padding-left: 18px;
  margin-bottom: 6px;
 }

 .topic-list li::before {
  content: "‚Üí";
  position: absolute;
  left: 0;
  color: var(--color-primary);
  }

</style>
</head>
<body>
  <div style="text-align: center; margin-bottom: 30px;">
  <a href="index.html">
    <img src="logo-brainboxmed-transparent.png" alt="BrainboxMed Logo" style="max-width: 250px; cursor: pointer;">
  </a>
</div>

  <h1 id="report-title">Relat√≥rio Final</h1>
  <div class="summary" id="summary"></div>
  <h2 id="last-questions-title">√öltimas 10 Quest√µes</h2>
  <div id="review"></div>
  <div id="review-navigation" style="text-align: center; margin-top: 30px;">
  <button id="prev-btn" class="btn btn-primary" style="display: none;">‚¨ÖÔ∏è Previous</button>
  <span id="page-indicator" style="margin: 0 20px; font-weight: bold; font-size: 16px;"></span>
  <button id="next-btn" class="btn btn-primary">Next ‚û°Ô∏è</button>
  </div>
  <div id="review-cta" style="text-align: center; margin-top: 40px;">
  <p id="full-review-invite" style="font-size: 18px; font-weight: bold; margin-bottom: 10px; color: var(--color-primary);">
  Review full question set?
</p>
<button id="full-report-link" onclick="showFullReport()" class="btn btn-highlight">
  üìã View Full Report
  </button>
</div>

<script>
const allQuestions = JSON.parse(localStorage.getItem('acumuladoQuestoes')) || [];
const allAnswers = JSON.parse(localStorage.getItem('acumuladoRespostas')) || {};
const idioma = localStorage.getItem('selectedLanguage') || 'pt';
drawPerformanceChart(allQuestions, allAnswers, idioma);

const reviewContainer = document.getElementById('review');
let currentPage = 0;
const questionsPerPage = 10;
const totalPages = Math.ceil(allQuestions.length / questionsPerPage);

function renderPage(page) {
  reviewContainer.innerHTML = '';

  const start = page * questionsPerPage;
  const end = start + questionsPerPage;
  const pageQuestions = allQuestions.slice(start, end);

  pageQuestions.forEach((q, i) => {
    const userAnswer = allAnswers[q.id];
    const isCorrect = userAnswer === q.correta;
    const hasAnswer = typeof userAnswer !== 'undefined';

    const enunciado = q.pergunta?.[idioma] || q.pergunta?.pt || '';
    const alternativas = q.alternativas || [];
    const explicacao = alternativas[q.correta]?.explicacao?.[idioma] || '';

    const alternativasHTML = alternativas.map((alt, idx) => {
      const texto = alt.texto?.[idioma] || alt.texto?.pt || '';
      let classe = '';
      let prefix = '';

      if (idx === q.correta) {
        classe = 'correct';
        prefix = '‚úîÔ∏è ';
      }
      if (hasAnswer && idx === userAnswer && userAnswer !== q.correta) {
        classe = 'incorrect';
        prefix = '‚ùå ';
      }

      return `<div class="option ${classe}">${prefix}${texto}</div>`;
    }).join('');

    const block = document.createElement('div');
    block.className = 'question';
    block.innerHTML = `
      <h3 style="color: var(--color-primary); font-size: 20px;">üìò Question ${start + i + 1}</h3>
      <p style="font-weight: bold; font-size: 17px; margin-bottom: 15px;">${enunciado}</p>
      <div style="margin-bottom: 20px;">${alternativasHTML}</div>
      <div class="explanation ${isCorrect ? 'correct' : 'incorrect'}">
        ${isCorrect ? '‚úÖ Correct' : '‚ùå Incorrect'} ‚Äî ${explicacao}
      </div>
    `;
    reviewContainer.appendChild(block);
  });

  const indicatorTexts = {
  pt: `Bloco ${page + 1} de ${totalPages}`,
  en: `Set ${page + 1} of ${totalPages}`,
  es: `Bloque ${page + 1} de ${totalPages}`
  };


  document.getElementById('page-indicator').textContent = indicatorTexts[idioma] || indicatorTexts.en;
  document.getElementById('prev-btn').style.display = page > 0 ? 'inline-block' : 'none';
  document.getElementById('next-btn').style.display = page < totalPages - 1 ? 'inline-block' : 'none';
}

document.getElementById('prev-btn').addEventListener('click', () => {
  if (currentPage > 0) {
    currentPage--;
    renderPage(currentPage);
  }
});

document.getElementById('next-btn').addEventListener('click', () => {
  if (currentPage < totalPages - 1) {
    currentPage++;
    renderPage(currentPage);
  }
});

renderPage(currentPage);
</script>
<script>
document.addEventListener('DOMContentLoaded', function () {
  const lang = localStorage.getItem('selectedLanguage') || 'pt';

  const fullReviewTexts = {
    pt: {
      invite: "Deseja revisar todas as quest√µes respondidas?",
      button: "üìã Ver Relat√≥rio Completo"
    },
    en: {
      invite: "Review full question set?",
      button: "üìã View Full Report"
    },
    es: {
      invite: "¬øRevisar todas las preguntas respondidas?",
      button: "üìã Ver Informe Completo"
    }
  };

  const t = fullReviewTexts[lang];
  document.getElementById("full-review-invite").textContent = t.invite;
  document.getElementById("full-report-link").textContent = t.button;
});
</script>
  <div style="text-align: center; margin-top: 50px;">
  <button class="btn btn-primary" onclick="confirmReturnHome()" style="font-size: 16px;">
    üè† Return to Home Page
  </button>
  <button class="btn btn-highlight" onclick="resetCycle()" style="font-size: 16px; margin-left: 15px;">
    üîÑ Restart Cycle
  </button>
  </div>

<script>
document.addEventListener('DOMContentLoaded', function () {
  const lang = localStorage.getItem('selectedLanguage') || 'en';
  document.documentElement.lang = lang;

  const translations = {
    en: {
      title: "Final Report",
      subtitle: "Last 10 Questions",
      invite: "Review full question set?",
      button: "üìã View Full Report",
      prev: "‚¨ÖÔ∏è Previous",
      next: "Next ‚û°Ô∏è"
    },
    pt: {
      title: "Relat√≥rio Final",
      subtitle: "√öltimas 10 Quest√µes",
      invite: "Deseja revisar todas as quest√µes respondidas?",
      button: "üìã Ver Relat√≥rio Completo",
      prev: "‚¨ÖÔ∏è Anterior",
      next: "Pr√≥xima ‚û°Ô∏è"
    },
    es: {
      title: "Informe Final",
      subtitle: "√öltimas 10 Preguntas",
      invite: "¬øRevisar todas las preguntas respondidas?",
      button: "üìã Ver Informe Completo",
      prev: "‚¨ÖÔ∏è Anterior",
      next: "Siguiente ‚û°Ô∏è"
    }
  };

  const t = translations[lang] || translations.en;

  const setText = (id, text) => {
    const el = document.getElementById(id);
    if (el) el.textContent = text;
  };

  setText("report-title", t.title);
  setText("last-questions-title", t.subtitle);
  setText("full-review-invite", t.invite);
  setText("full-report-link", t.button);
  setText("prev-btn", t.prev);
  setText("next-btn", t.next);
});
</script>
<script src="relatorio.js" defer></script>
</body>
</html>